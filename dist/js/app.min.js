(()=>{"use strict";const e="https://www.thecocktaildb.com/api/json/v1/1/",t=async function(e){try{const t=await Promise.race([fetch(e),(5,new Promise((function(e,t){setTimeout((function(){t(new Error("Request took too long! Timeout after 5 second"))}),5e3)})))]),n=await t.json();if(!n.drinks)throw new Error("Cocktail is not found, sorry ü•∫");return n}catch(e){throw e}},n={cocktail:{},search:{query:"",results:[],currentPage:1,resultsPerPage:5}};class r{data;render(e){if(this.data=e,!e||e.isArray&&0!==e.length)return this.renderError();const t=this.generateMarkup();this.clear(),this.paste(t)}clear(){this.parentElement.innerHTML=""}paste(e){this.parentElement.insertAdjacentHTML("afterbegin",e)}renderSpinner(){this.clear(),this.paste('<div class="spinner">\n\t <svg>\n\t\t<use href="../../img/icons.svg#icon-spinner"></use>\n\t </svg>\n  </div>')}renderError(e=this.errorMessage){const t=`<div class="error">\n\t <div>\n\t\t<svg>\n\t\t  <use href="../../img/icons.svg#icon-bulb"></use>\n\t\t</svg>\n\t </div>\n\t <p>${e}</p>\n  </div>`;this.clear(),this.paste(t)}renderMessage(e=this.message){const t=`<div class="message">\n\t<div>\n\t  <svg>\n\t\t <use href="../../img/icons.svg#icon-bulb"></use>\n\t  </svg>\n\t</div>\n\t<p>${e}</p>\n </div>`;this.clear(),this.paste(t)}}const s=new class extends r{parentElement=document.querySelector(".recipe");errorMessage="Sorry, wrong requestü•∫";message="Start by searching for a cocktail or an ingredientüçπüç∏üçã";addHandlerRender(e){window.addEventListener("hashchange",e)}generateIngredientMarkup(e){return e.reduce(((e,t)=>e+`<li class="recipe__ingredient ingredient">\n\t\t  <figure class="ingredient__image">\n\t\t\t <img src="${t.ingredientThumbLink}" alt="${t.ingredientName}" />\n\t\t  </figure>\n\t\t  <span class="ingredient__name">${t.ingredientName}</span>\n\t\t  <span class="ingredient__measurement">${t.ingredientMeasure}</span>\n\t\t</li>`),"")}generateMarkup(){const e=this.generateIngredientMarkup(this.data.ingredientsArray);return`<figure class="recipe__figure">\n\t <img\n\t src="${this.data.imageURL}"\n\t\talt="${this.data.name}"\n\t\tclass="recipe__image"\n\t\tcrossorigin\n\t />\n\t <div class="recipe__header">\n\t\t<h1 class="recipe__title title title-1">\n\t\t  <span>${this.data.name}</span>\n\t\t</h1>\n\t\t<div class="recipe__user-generated">\n\t\t  <svg>\n\t\t\t <use href="./img/icons.svg#icon-star-empty"></use>\n\t\t  </svg>\n\t\t</div>\n\t </div>\n\t <div class="recipe__details details">\n\t\t<div class="details__item">\n\t\t  <p class="details__description">${"Alcoholic"===this.data.alcoholic?"üòà":"Non alcoholic"===this.data.alcoholic?"üëºüèº":"ü§î"}${this.data.alcoholic}</p>\n\t\t</div>\n\t\t<div class="details__item">\n\t\t  <p class="details__description">üçπ${this.data.glass}</p>\n\t\t</div>\n\t </div>\n  </figure>\n  <div class="recipe__body">\n\t <ul class="recipe__part recipe__ingredients">\n\t ${e}\n\t </ul>\n\t <div class="recipe__part recipe__instructions">\n\t ${this.data.instructions}\n\t </div>\n  </div>`}},i=new class{parentElement=document.querySelector(".search");clear(){this.parentElement.querySelector(".search__input").value=""}getQuery(){return this.parentElement.querySelector(".search__input").value}addHandlerSearch(e){this.parentElement.addEventListener("submit",(t=>{t.preventDefault(),e(),this.clear()}))}},a=new class extends r{parentElement=document.querySelector(".sidebar__list");errorMessage="Sorry, we couldn't find this drink in our collectionü•∫";message="Start by searching for a cocktail or an ingredientüçπüç∏üçã";generateMarkup(){return this.data.map((e=>`<li class="sidebar__item preview">\n\t<a class="preview__link" href="#${e.id}">\n\t  <figure class="preview__image">\n\t\t <img src=${e.imageURL} alt="${e.name}" crossorigin />\n\t  </figure>\n\t  <div class="preview__data">\n\t\t <h4 class="preview__title">${e.name}</h4>\n\t\t <p class="preview__additional">${e.category}</p>\n\t  </div>\n\t  <div class="preview__user-generated">\n\t\t <svg>\n\t\t\t<use href="../../img/icons.svg${e.favourite?"#icon-star-full":"#icon-star-empty"}"></use>\n\t\t </svg>\n\t  </div>\n\t</a>\n </li>`))}},c=new class extends r{parentElement=document.querySelector(".pagination__body");generateNumbers(){const e=this.data,t=this.calculateNumPages(e);let n="";for(let r=1;r<=t;r++)n+=this.generatePaginationNumber(r,e.currentPage);return n}generateMarkup(){const e=this.data,t=this.calculateNumPages(e);return`\n      ${this.generatePrevButton(e.currentPage)}\n      <div class="pagination__numbers" id="pagination-numbers">\n        ${this.generateNumbers()}\n      </div>\n      ${this.generateNextButton(e.currentPage,t)}\n    `}calculateNumPages(e){const t=e.results.length,n=e.resultsPerPage;return Math.ceil(t/n)}generatePaginationNumber(e,t){return`\n      <a href="#" class="pagination__number ${t===e?"active":""}">\n        ${e}\n      </a>\n    `}generatePrevButton(e){return`\n      <a href="#" class="pagination__arrow pagination__arrow_prev ${1===e?"disabled":""}" id="prev-button">\n        <svg><use href="./img/icons.svg#icon-circle-left"></use></svg>\n      </a>\n    `}generateNextButton(e,t){return`\n      <a href="#" class="pagination__arrow pagination__arrow_next ${e===t?"disabled":""}" id="next-button">\n        <svg><use href="./img/icons.svg#icon-circle-right"></use></svg>\n      </a>\n    `}},o=(document.querySelector(".recipe"),async function(){try{s.renderSpinner();const r=window.location.hash.slice(1);await async function(r){try{const s=(await t(`${e}lookup.php?i=${r}`)).drinks[0];function i(e){const t=[];for(let n=1;n<=15;n++){const r=e[`strIngredient${n}`],s=e[`strMeasure${n}`];r&&s&&t.push({ingredientName:r,ingredientMeasure:s,ingredientThumbLink:`https://www.thecocktaildb.com/images/ingredients/${r.toLowerCase()}-Small.png`})}return t}const a=i(s);n.cocktail={id:s.idDrink,name:s.strDrink,alcoholic:s.strAlcoholic,glass:s.strGlass,instructions:s.strInstructions,imageURL:s.strDrinkThumb,ingredientsArray:a}}catch(c){throw c}}(r);const{cocktail:i}=n;s.render(i)}catch(e){s.renderError()}});s.addHandlerRender(o),s.renderMessage(),i.addHandlerSearch((async function(){try{a.renderSpinner();const r=i.getQuery();if(!r)return;await async function(r){try{n.search.query=r;const s=(await t(`${e}search.php?s=${r}`)).drinks;n.search.results=s.map((e=>({id:e.idDrink,name:e.strDrink,category:e.strCategory,imageURL:e.strDrinkThumb,favourite:!1})))}catch(e){throw e}}(r),a.render(function(e=n.search.currentPage){n.search.currentPage=e;const t=5*(e-1),r=t+5;return n.search.results.slice(t,r)}()),c.render(n.search)}catch(e){a.renderError()}}))})();